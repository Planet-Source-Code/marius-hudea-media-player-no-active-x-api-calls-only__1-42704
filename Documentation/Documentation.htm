<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./Documentation.files/filelist.xml">
<title>Media Player</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Marius Hudea</o:Author>
  <o:LastAuthor>Marius Hudea</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>239</o:TotalTime>
  <o:Created>2002-07-26T11:10:00Z</o:Created>
  <o:LastSaved>2002-07-26T11:11:00Z</o:LastSaved>
  <o:Pages>6</o:Pages>
  <o:Words>2392</o:Words>
  <o:Characters>13636</o:Characters>
  <o:Company>Home</o:Company>
  <o:Lines>113</o:Lines>
  <o:Paragraphs>27</o:Paragraphs>
  <o:CharactersWithSpaces>16745</o:CharactersWithSpaces>
  <o:Version>9.3007</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HyphenationZone>21</w:HyphenationZone>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:windowtext;
	mso-font-kerning:0pt;
	font-weight:bold;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	color:windowtext;
	font-weight:bold;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:windowtext;
	font-weight:normal;
	font-style:italic;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	border:none;
	mso-border-bottom-alt:solid windowtext .75pt;
	padding:0in;
	mso-padding-alt:0in 0in 1.0pt 0in;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	color:windowtext;
	font-weight:normal;}
h5
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	color:windowtext;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:18.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
@page Section1
	{size:8.5in 11.0in;
	margin:45.0pt .75in 1.0in 1.25in;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:298923842;
	mso-list-type:hybrid;
	mso-list-template-ids:983449472 68681743 68681753 68681755 68681743 68681753 68681755 68681743 68681753 68681755;}
@list l0:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:583804927;
	mso-list-type:hybrid;
	mso-list-template-ids:1546576086 68681729 68681731 68681733 68681729 68681731 68681733 68681729 68681731 68681733;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2
	{mso-list-id:727729900;
	mso-list-type:hybrid;
	mso-list-template-ids:650563854 68681729 68681731 68681733 68681729 68681731 68681733 68681729 68681731 68681733;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3
	{mso-list-id:847407475;
	mso-list-type:hybrid;
	mso-list-template-ids:2129138486 68681743 68681753 68681755 68681743 68681753 68681755 68681743 68681753 68681755;}
@list l3:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:1195730910;
	mso-list-type:hybrid;
	mso-list-template-ids:12589808 68681729 68681731 68681733 68681729 68681731 68681733 68681729 68681731 68681733;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5
	{mso-list-id:1200163146;
	mso-list-type:hybrid;
	mso-list-template-ids:555137412 68681729 68681731 68681733 68681729 68681731 68681733 68681729 68681731 68681733;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:39.0pt;
	mso-level-number-position:left;
	margin-left:39.0pt;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6
	{mso-list-id:1240943502;
	mso-list-type:hybrid;
	mso-list-template-ids:2117883422 68681729 68681731 68681733 68681729 68681731 68681733 68681729 68681731 68681733;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7
	{mso-list-id:1424298606;
	mso-list-type:hybrid;
	mso-list-template-ids:1452827454 68681729 68681731 68681733 68681729 68681731 68681733 68681729 68681731 68681733;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8
	{mso-list-id:1780711114;
	mso-list-type:hybrid;
	mso-list-template-ids:-1605854712 68681729 68681731 68681733 68681729 68681731 68681733 68681729 68681731 68681733;}
@list l8:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l9
	{mso-list-id:2106489598;
	mso-list-type:hybrid;
	mso-list-template-ids:1153344212 68681729 68681731 68681733 68681729 68681731 68681733 68681729 68681731 68681733;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body lang=RO link=blue vlink=purple style='tab-interval:35.4pt'>

<div class=Section1>

<p class=MsoTitle>Media Player</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal align=right style='text-align:right'><b>By Marius Hudea</b>
( <a href="mailto:marius_hudea@personal.ro">marius_hudea@personal.ro</a>)</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The purpose of this application is to teach you how to use
the Windows MCI Interface in order to play audio &amp; video files without
using any Active-X controls.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>First of all I
would like to mention some people that helped me a lot, directly or indirectly.
</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>I am mentioning
his name here because they deserve it and because I don’t want people to think
I have stolen their code and that I am using their work to receive credit for
it.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo2;tab-stops:list .5in'><b>Abdullah
     Al-Ahdal</b> (<a href="mailto:a_ahdal@yahoo.com">a_ahdal@yahoo.com</a>)</li>
</ol>

<p class=MsoNormal style='margin-left:.5in'><span style="mso-spacerun: yes"> 
</span>It all started from him and he should receive a lot of the credits. He
was the one that made me start this project. His work,<span
style="mso-spacerun: yes">  </span>available on Planet Source Code, was great
but contained a lot of imperfections and I wanted to improve it. What I did
turned into a completly different media player.</p>

<p class=MsoNormal style='margin-left:.5in'><span style="mso-spacerun:
yes"> </span></p>

<ol style='margin-top:0in' start=2 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo2;tab-stops:list .5in'><b>The
     KPD Team</b><span style="mso-spacerun: yes">  </span>(<a
     href="mailto:KPDTeam@allapi.net">KPDTeam@allapi.net</a>)</li>
</ol>

<p class=MsoNormal style='margin-left:.5in'><span style="mso-spacerun: yes"> 
</span>They<span style="mso-spacerun: yes">  </span>have designed the
wonderfull application <b>API-Guide</b>. I must admit that it is hard for me to
remember all those API functions and constants so <b>API-Guide</b> is a big
help. It earned a place in my taskbar. It’s so sad that they can no longer
continue improving their application.</p>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ol style='margin-top:0in' start=3 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo2;tab-stops:list .5in'><b>Planet
     Source Code</b> (<a href="http://www.planet-source-code.com/">http://www.planet-source-code.com</a>)</li>
</ol>

<p class=MsoNormal style='margin-left:.5in'><span style="mso-spacerun: yes"> 
</span>A special <i>Thank You!</i><span style="mso-spacerun: yes">  </span>goes
to all the people that continue working on free projects and to the ones that
help others improve their programming skills.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>LIKE ANYTHING ELSE THAT'S FREE, THIS PROJECT IS PROVIDED AS
IS AND COMES WITH NO WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED. IN NO
EVENT WILL THE AUTHOR BE LIABLE FOR ANY DAMAGES RESULTING FROM THE USE OF THIS
SOFTWARE.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>I have worked a lot
on this project and I believe it is safe to use. However, this project is
provided as-is, without any guarantees that it will work or that will not
generate any errors.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>It works great on
my computer, my friends also tested this project and they found it safe to use
but I had to say that because</p>

<p class=MsoNormal>I don’t want anybody to blame me if something goes
wrong.<span style="mso-spacerun: yes">   </span></p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>You may use this
source code in any projects you work on as long as they are free or if you are
using code from my project for educational-related programs. If you are going
to use this in a commercial application I will not stop you or sue you but I
would like you to write my name somewhere in the help files or in the About Box
of<span style="mso-spacerun: yes">  </span>your application. I would also like
to receive a (registered) copy of<span style="mso-spacerun: yes">  </span>your
application.</p>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h5>Introduction</h5>

<p class=MsoNormal><b><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal>First of all, what is MCI ? </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>As the Microsoft MSDN says:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><i><span style="mso-spacerun: yes"> </span>„The Media
Control Interface (MCI) provides standard commands for playing multimedia
devices and recording multimedia resource files. These commands are a generic
interface to nearly every kind of multimedia device.”<o:p></o:p></i></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>So, by using the
MCI, we could play virtually any media file, audio or video, if we have a
propper multimedia device.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>Ok, but what is a
multimedia device ? As far as I know, you could imagine that a multimedia
device is a software driver that receives commands and performs things for you.
A multimedia device is is a library that uses software codecs installed on your
computer to translate into something that can be played on your soundcard or on
your video card.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>For example, in
this project I am using a multimedia device called „<b>MPEGVideo</b>” to play
the well-known <b>*.mp3</b> files. This multimedia device can handle any <i>MPEG</i>
files, audio or video and also other file formats. The multimedia device will
load a codec on your computer, usually „<i>Fraunhofer ILS MPEG Layer-3 Codec”</i>
( if the selected file was a *.mp3 ), and will use it to play the file on your
sound card.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>This multimedia
device can also decode <b>*.avi</b> files.In this project I am using this
device to play <b>*.avi</b> files because, on my computer it is faster.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">    </span>You can get a
list of the available multimedia devices on your computer by viewing the <i>System.ini</i>
file, located in your Windows folder. You can see both at the same time by
running the <i>SysEdit </i><span style="mso-spacerun: yes"> </span>or the <i>msconfig</i>
program.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">    </span>Bellow is the
list of multimedia devices that normally are installed automatically when you
install Windows.</p>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=1 cellspacing=3 cellpadding=0 style='mso-cellspacing:2.0pt;
 margin-left:20.75pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='height:13.8pt'>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Multimedia
  Device<o:p></o:p></b></p>
  </td>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Description<o:p></o:p></b></p>
  </td>
 </tr>
 <tr style='height:13.8pt'>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal><b>cdaudio<o:p></o:p></b></p>
  </td>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal>Plays Audio-CD’s</p>
  </td>
 </tr>
 <tr style='height:13.8pt'>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal><b>waveaudio<o:p></o:p></b></p>
  </td>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal>Plays *.wav files and compatibles</p>
  </td>
 </tr>
 <tr style='height:13.8pt'>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal><b>sequencer<o:p></o:p></b></p>
  </td>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal>Plays *.mid &amp; *.rmi files ( midi )</p>
  </td>
 </tr>
 <tr style='height:13.8pt'>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <h1>MPEGVideo</h1>
  </td>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal>Plays most video &amp; audio files </p>
  </td>
 </tr>
 <tr style='height:13.8pt'>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal><b>avivideo<o:p></o:p></b></p>
  </td>
  <td width=307 valign=top style='width:3.2in;padding:0in 5.4pt 0in 5.4pt;
  height:13.8pt'>
  <p class=MsoNormal>Plays *.avi files ( see note )</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><i><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></i></p>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><span style="mso-spacerun:
yes">  </span>You could use the <b>avivideo</b> multimedia device to play <b>*.avi
</b>files but I don’t recommend it. As far as I know, this multimedia</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'>device uses only the GDI system
in order to accelerate the playback. This is why you might notice frame losses
or slow rendering of the video file.</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><span style="mso-spacerun:
yes">  </span>It seems that the <b>MPEGVideo</b> uses a lot of functions that
accelerate the playback of video files, overlays beeing just one of them.</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">     </span>The <i>Multimedia
Controle Interface</i> can be accessed using two API functions contained in the
<i>winmm.dll</i> library.<span style="mso-spacerun: yes">       </span></p>

<p class=MsoNormal>&nbsp;</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l2 level1 lfo3;tab-stops:list .5in'><span
     style='font-size:10.0pt;mso-bidi-font-size:12.0pt;color:blue'>Declare
     Function</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'>
     mciSendString <span style='color:blue'>Lib</span> &quot;winmm.dll&quot; <span
     style='color:blue'>Alias</span> &quot;mciSendStringA&quot; ( <span
     style='color:blue'>ByVal</span> lpstrCommand <span style='color:blue'>As
     String</span>, <span style='color:blue'>ByVal </span>lpstrReturnString <span
     style='color:blue'>As String</span>, <span style='color:blue'>ByVal</span>
     uReturnLength <span style='color:blue'>As Long</span>, <span
     style='color:blue'>ByVal</span> hwndCallback <span style='color:blue'>As
     Long</span>) <span style='color:blue'>As Long</span><o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l2 level1 lfo3;tab-stops:list .5in'><span
     style='font-size:10.0pt;mso-bidi-font-size:12.0pt;color:blue'>Declare
     Function</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'>
     mciGetErrorString <span style='color:blue'>Lib</span>
     &quot;winmm.dll&quot; <span style='color:blue'>Alias</span>
     &quot;mciGetErrorStringA&quot; ( <span style='color:blue'>ByVal</span>
     dwError <span style='color:blue'>As Long</span>, <span style='color:blue'>ByVal
     </span>lpstrBuffer As String, <span style='color:blue'>ByVal</span>
     uLength <span style='color:blue'>As Long</span>) <span style='color:blue'>As
     Long</span><o:p></o:p></span></li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent><span style="mso-spacerun: yes">  </span>Well, only
the first function is really important but the seconds is usefull if we want to
show a text explaining what happened if an error has occured.</p>

<p class=MsoNormal style='margin-left:.25in'><span style="mso-spacerun: yes"> 
</span>The <i>mciSendString</i> function is used to send commands to the <i>MCI
</i><span style="mso-spacerun: yes"> </span>and will always will return a value
(<span style='color:blue'>Long</span>) that will be 0 (zero) is everything is
Ok or an error code. The error code can’t explain us the error, that is why we
will use the <i>mciGetErrorString</i> function that will give us a text
explaining what happened</p>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.25in'>Here’s what the <i>mciSendString</i>
parameters mean:</p>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>lpstrCommand</p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:.2in'>A command
string.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>lpstrReturnString</p>

<p class=MsoNormal style='text-indent:35.4pt'>A buffer (String) that receives
return information. If no return information is needed, this parameter can be
NULL.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>uReturnLength</p>

<p class=MsoNormal style='text-indent:35.4pt'>Size, in characters, of the
return buffer specified by the lpstrReturnString parameter.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>hwndCallback</p>

<p class=MsoNormal style='margin-left:35.4pt'>Handle of a callback window if
the “notify” flag was specified in the command string. This will not be used by
our project and will always be NULL.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.25in'>Here’s what the <i>mciGetErrorString</i>
parameters mean:</p>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>dwError</p>

<p class=MsoNormal style='margin-left:39.0pt'>The error code. ( The value
returned by the <i>mciSendString </i>function )</p>

<p class=MsoNormal style='margin-left:39.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>lpstrBuffer</p>

<p class=MsoNormal style='margin-left:39.0pt'>A buffer (String) that receives
return information ( the error message)</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>uLength</p>

<p class=MsoNormal style='margin-left:39.0pt'>Size, in characters, of the
return buffer specified by the lpstrBuffer parameter.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">     </span>If everything goes
well, the <i>mciSendString </i>function should return 0 (zero)</p>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">      </span>I have created
functions or procedures that simplify the interaction with <i>MCI.<o:p></o:p></i></p>

<p class=MsoNormal><span style="mso-spacerun: yes">      </span>Each function
that interacts with <i>MCI</i> will return a value (<span style='color:blue'>Boolean</span>).
It will be <span style='color:blue'>True</span> or <span style='color:blue'>False
</span>if an error has ocurred.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">      </span>I am also using
4 ( four ) variables in my project that hold the status of the current audio or
video stream:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:blue'>Public</span> IsLoaded <span
style='color:blue'>As Boolean</span></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:blue'>Public</span> IsPlaying <span
style='color:blue'>As Boolean</span></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:blue'>Public </span>IsPaused <span
style='color:blue'>As Boolean</span></p>

<p class=MsoNormal style='margin-left:39.0pt;text-indent:-.25in;mso-list:l5 level1 lfo4;
tab-stops:list 39.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:blue'>Public</span> IsFullscreen <span
style='color:blue'>As Boolean</span><span style="mso-spacerun: yes">    
</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='color:blue'>IsLoaded</span> – A media file (
called Stream ) is loaded ( with the OpenStream function ). If we want to open
another file, the<span style="mso-spacerun: yes">   </span>previous media file
loaded must be closed. IsLoaded is True is a file is open.</p>

<p class=MsoNormal><span style='color:blue'>IsPlaying</span> – A media file is
playing at the current time. This is usefull because most commands are working
only when a file is playing.</p>

<p class=MsoNormal><span style='color:blue'>IsPaused</span> – A media file is
playing and is paused. When a media file is paused we should not refresh the
file position on progress bars and we should stop any subtitles.</p>

<p class=MsoNormal><span style='color:blue'>IsFullScreen </span>– The media
file is a video file and it is in <span style='color:blue'>Full Screen</span>
Mode.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">      </span>Note. The
functions or the sub’s in the <i>modMCI </i>module will not change these
variables, you will have to change them in the application if needed,
considering the return code the functions will return.</p>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>Opening a media file…</h2>

<p class=MsoNormal><span style='font-size:16.0pt;mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
color:blue'>Public</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'>
<span style='color:blue'>Function</span> OpenStream(VideoHandle <span
style='color:blue'>As Long</span>, FileTitle <span style='color:blue'>As String</span>)
<span style='color:blue'>As Boolean<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>This function will open a media file and returns <span
style='color:blue'>True </span>if everithing is Ok.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Parameters:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l9 level1 lfo5;tab-stops:list .5in'>VideoHandle
     – A window handle ( <span style='color:blue'>hWnd </span>). See the note
     bellow if you don’t understand what is this.</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo5;tab-stops:list .5in'>FileTitle
     – The file name. ( with the path included ) Ex. <i>C:\Music\MyArtist-The
     Song.mp3</i></li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h3>What is a VideoHandle?</h3>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>Every window has
it’s own handle. Think of it as the nail that holds a painting on the wall.
It’s an unique identifier.</p>

<p class=MsoNormal>What is interesting is that even buttons, menu’s, scrollbars
are actually windows so you could actually play a video in a button.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The <i>MCI</i> requires a valid window handle. In my project
the VideoHandle is the handle of the <i>frmView</i> window or the handle of the
<i>frmFullscreen</i> window ( when in Full Screen ) mode. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The command string that the function will send to the <i>MCI
</i>is the following:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyText>&quot;open &quot; &amp; StreamName &amp; &quot; type
&quot; &amp; StreamDevice &amp; &quot; Alias &quot; &amp; StreamAlias &amp;
&quot; parent &quot; &amp; VideoWindowHandle &amp; &quot; Style child&quot;</p>

<p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>Or, in plain English ( you can’t send this string to the <i>MCI
</i>):</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'>„Open
the filename that has the multimedia device <i>StreamDevice</i> , call the
media from now on StreamAlias and make the parent window the window that has
the handle VideoHandle.The video window will have the style <i>style</i>”<o:p></o:p></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Note: The maximum length of the string commands accepted by
the <i>mciSendString </i><span style="mso-spacerun: yes"> </span>is 255
characters.</p>

<p class=MsoNormal><span style='color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:blue'>Open</span> – tells <i>MCI</i> to
open the file </p>

<p class=MsoNormal><span style='color:blue'>StreamName</span> – The filename.
This could be very long, that’s why it must be reduced it somehow. And it’s not
allowed to contain spaces. I’ll use a function in a standard library that comes
with Windows to convert the filename to it’s MS-DOS representation. For example
: </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>C:\Caffe Concert\ Dave Stewart &amp; Candy Dulfer - Lili was
Here.mp3 <span style='font-family:Symbol;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>®</span></span><span
style="mso-spacerun: yes">  </span>C:\Caffec~1\Davest~1.mp3</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The function is the following:</p>

<p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
color:blue'>Private Declare Function</span><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt'> GetShortPathName <span style='color:blue'>Lib</span>
&quot;kernel32&quot; <span style='color:blue'>Alias</span>
&quot;GetShortPathNameA&quot; (<span style='color:blue'>ByVal</span>
lpszLongPath <span style='color:blue'>As String</span>, <span style='color:
blue'>ByVal</span> lpszShortPath <span style='color:blue'>As String</span>, <span
style='color:blue'>ByVal</span> cchBuffer <span style='color:blue'>As Long</span>)
<span style='color:blue'>As Long</span></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:blue'>LpszLongPath</span> – The original
Filename</p>

<p class=MsoNormal><span style='color:blue'>LpszShortPath</span> – <span
style='mso-field-code:FILENAME'></span><span style="mso-spacerun:
yes"> </span>A buffer (String) where the new short filename will be stored.</p>

<p class=MsoNormal><span style='color:blue'>CchBuffer</span> – The length, in
characters, of the buffer.</p>

<p class=MsoNormal><span style="mso-spacerun: yes"> </span></p>

<p class=MsoNormal>It returns the length of the new string that holds the short
filename.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='color:blue'>StreamDevice </span>– The
multimedia device that will be used to play the media file.</p>

<p class=MsoNormal>In my project I am using another function in the same module
to select the proper multimedia device</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='color:blue'>StreamAlias </span>– This is a name
, a nick, an unique identifier that will be used to tell <i>MCI</i> what to do
with the opened media file.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Note: If you are going to use a constant string ( ex. <i>MyMP3</i>
) you’ll have problems if another instance of your application is opened
because the alias is already in use. The problem is that you will not be able
to open a second file using the same alias.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>This is why you
should generate an unique StreamAlias each time you open a new media file by
using the <i>Rnd()</i><span style='color:blue'> </span>function that comes with
Visual Basic or any other method.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>In my project I am
using<span style="mso-spacerun: yes">  </span>the number<span style='color:
blue'> </span>of milliseconds that have elaspsed since Windows was started.
There is<span style="mso-spacerun: yes">  </span>a possibility for two
instances of your application to open a file at the same time but the
possibility it is very small ( smaller than using <i>Rnd() </i>)</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>The function that
will return the number of milliseconds elapsed since Windows started is :</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
color:blue'>Private Declare</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt'> <span style='color:blue'>Function</span> GetTickCount <span
style='color:blue'>Lib</span> &quot;kernel32&quot; () <span style='color:blue'>As</span>
<span style='color:blue'>Long<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>It simply retuns
the number of milliseconds.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>Note: There is a
famous Windows bug here, but it is not caused by the project or by accessing
the function. When Windows reaches the maximum value accepted by the <span
style='color:blue'>Long</span> type ( about<span style="mso-spacerun: yes"> 
</span>25 days, if your computer stays on for that long ), it will crash.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>However, there is a
patch for this bug on Microsoft’s web site. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='color:blue'>VideoWindowHandle </span>– It’s the
VideoHandle parameter that you have passed to the function. It tells <i>MCI</i>
that his parent window is the window that has the handle <i>VideoWindowHandle </i>.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='color:blue'>Style – </span>Represents the style
of the window. It can be a string constant or a <span style='color:blue'>Long </span>variable<span
style='color:blue'> </span>like in the command string shown previously.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Possible styles :</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=1 cellspacing=0 cellpadding=0 width="60%" style='width:60.02%;
 margin-left:.5in;border-collapse:collapse;border:none;mso-border-alt:solid windowtext 1.0pt'>
 <tr style='height:22.5pt'>
  <td width="38%" valign=top style='width:38.08%;border:solid windowtext 1.0pt;
  padding:.75pt .75pt .75pt .75pt;height:22.5pt'>
  <p class=MsoNormal>style child</p>
  </td>
  <td width="59%" valign=top style='width:59.28%;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext 1.0pt;padding:.75pt .75pt .75pt .75pt;
  height:22.5pt'>
  <p class=MsoNormal>Opens a window with a child window style.</p>
  </td>
 </tr>
 <tr style='height:20.85pt'>
  <td width="38%" valign=top style='width:38.08%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext 1.0pt;padding:.75pt .75pt .75pt .75pt;
  height:20.85pt'>
  <p class=MsoNormal>style overlapped</p>
  </td>
  <td width="59%" valign=top style='width:59.28%;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext 1.0pt;mso-border-left-alt:solid windowtext 1.0pt;
  padding:.75pt .75pt .75pt .75pt;height:20.85pt'>
  <p class=MsoNormal>Opens a window with an overlapped window style.</p>
  </td>
 </tr>
 <tr style='height:24.0pt'>
  <td width="38%" valign=top style='width:38.08%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext 1.0pt;padding:.75pt .75pt .75pt .75pt;
  height:24.0pt'>
  <p class=MsoNormal>style popup</p>
  </td>
  <td width="59%" valign=top style='width:59.28%;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext 1.0pt;mso-border-left-alt:solid windowtext 1.0pt;
  padding:.75pt .75pt .75pt .75pt;height:24.0pt'>
  <p class=MsoNormal>Opens a window with a pop-up window style.</p>
  </td>
 </tr>
 <tr style='height:20.85pt'>
  <td width="38%" valign=top style='width:38.08%;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext 1.0pt;padding:.75pt .75pt .75pt .75pt;
  height:20.85pt'>
  <p class=MsoNormal>style style_type</p>
  </td>
  <td width="59%" valign=top style='width:59.28%;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext 1.0pt;mso-border-left-alt:solid windowtext 1.0pt;
  padding:.75pt .75pt .75pt .75pt;height:20.85pt'>
  <p class=MsoNormal>Indicates a window style.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>Well, that’s how
you open a media file. All you have to remember is to close the media file when
your application closes, otherwise the media will remain running in the
background and you won’t be able to stop it (unless you know the StreamAlias).</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>I believe this
function was the hardest. I have tried to make this whole project very easy to
understand. I hate inserting </p>

<p class=MsoNormal>comments in source code so, please try to understand me.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>There are also
some things that you might think I forgot to do or that I did them on the run
but I have tried to keep this whole </p>

<p class=MsoNormal>project as simple as possible.</p>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>Testing Configuration </h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>This project was tested on several computers with different
configurations.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><i>My computer:<o:p></o:p></i></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Home-made AMD K6-2 3D Now! 500 MHz ,160MB SDRAM , nVIDIA
Vanta 8 MB SDRAM, Win98 SE</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h3>My friend’s PC:</h3>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Home-made AMD K6-2 3D Now! 350 MHz, 64 MB SDRAM, nVIDIA
Vanta 8MB SDRAM, <a href="mailto:Win@K"><span style='color:windowtext;
text-decoration:none;text-underline:none'>Win2</span></a>000 Pro</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><i>My sister’s old PC:<o:p></o:p></i></p>

<p class=MsoNormal><i><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></i></p>

<p class=MsoNormal>Siemens-Nixdorf Intel-P90 MHz , 64 MB SDRAM, Tseng Labs 2 MB
VRAM, Win95 Pan European Edition</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>It works great on
my computer, runs all movies, even DivX 5 Wide Screen without glitches and
without freezing the</p>

<p class=MsoNormal>Screen. My friend has problems with wide-screen DivX 5
movies because it has only 64 MB SDRAM. My sister can</p>

<p class=MsoNormal>not see movies on her old ( antique) computer but she enjoys
listening to MP3 music with my program. (and the music</p>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'>runs great on that computer).</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><b><i><span style='font-size:
16.0pt;mso-bidi-font-size:12.0pt'>Tested on:<o:p></o:p></span></i></b></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><span style='font-size:16.0pt;
mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'>A Beautiful Mind ( 2 CD’s DVD
Rip 23.976 fps<span style="mso-spacerun: yes">  </span>- DivX 5)</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'>Eyes Wide Shut<span
style="mso-spacerun: yes">  </span>( 1 CD Video Tape Rip 23.976fps AngelPotion
MPEG-4 Codec )</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'>Monsters Inc.<span
style="mso-spacerun: yes">  </span>( 1CD DVD Rip 23.976fps DivX)</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'>A lot<span style="mso-spacerun:
yes">  </span>of<span style="mso-spacerun: yes">  </span>Trance,
Dream-Trance<span style="mso-spacerun: yes">  </span>&amp; Oldies music</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'>My personal favourites : ATB ,
Dj Taucher,Paul Oakenfold, Trance All Stars.</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><span style='mso-tab-count:3'>                                   </span><span
style="mso-spacerun: yes">  </span>Mike Oldfield<span style="mso-spacerun:
yes">   </span></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h5>Known Bugs</h5>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><b><span style='font-size:14.0pt;
mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><span style="mso-spacerun:
yes">  </span>I know there are some small bugs in this project. Please mail me
if you fiind some serios bugs because I’ll try to fix them as soon as possible.
I have chosen not to fix some small bugs ( like the one explained bellow)
because the solution would only complicate things a lot.</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'>Bugs :</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l8 level1 lfo6;
tab-stops:list .25in;border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>I have found that on my computer, if i install the <i>AC3
Audio</i> Direct Show codec, the *.mp3 playback is seriously altered. Files
that have a variable bitrate or files that are not coded at standard bitrate (
128kbs, 192kbps, 320kbs) will be heard with pops and glitches. The <i>MCI</i>
autodetects the best codec and will select this one. </p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l8 level1 lfo6;
tab-stops:list .25in;border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>On files with variable bitrate the total time is not
properly detected but the progress bar is running well. This is again <i>MCI</i>’s
fault because ( I believe ) it only scans the first frames of the files and
doesn’t test all the frames in order to properly detect their bitrate.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l8 level1 lfo6;
tab-stops:list .25in;border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Time is not properly detected on video files without
sound. I won’t bother fixing this. I don’t think it is the purpose of this
project.</p>

</div>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><span style="mso-spacerun:
yes">   </span>Currently only 3 lines of subtitling are accepted. I should not
consider this one a bug because I haven’t found yet any subtitles with more
than 3 lines of text. The way I show this text on the screen is not a very smart
one but, as I already said, this was not the purpose of the project.</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><span style="mso-spacerun:
yes">   </span>Only microDVD and SubRIP subtitles are decoded by the subtitles
module at this moment.</p>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Final notes : </p>

<p class=MsoNormal><span style="mso-spacerun: yes"> </span></p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>I have studied
English for over 10 years and I want to improve it so, if you fiind any
grammatical or language errors, please mail me and tell me where I have made an
error.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>Please don’t vote
for me on <i>Planet Source Code</i> unless I really deserve it. I did not do
this for votes. </p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>However, voting is
the only way I will know how good I am at programming. If you do vote, be
honest.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>If you fiind any
errors or if you need extra information regarding this project, mail me.</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>If you can, please
send me a postcard ( is it post-card? ) with a picture of your town or your
country.</p>

<div style='border:none;border-bottom:solid windowtext .75pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoNormal style='border:none;mso-border-bottom-alt:solid windowtext .75pt;
padding:0in;mso-padding-alt:0in 0in 1.0pt 0in'><span style="mso-spacerun:
yes"> </span><span style="mso-spacerun: yes"> </span></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>Oh, you have made
it. You have reached the end of the document. Thank you for your time. Here’s
my mail and my snail-mail in case you want to contact me. Please don’t send me
advertising stuff . <span style='font-family:Wingdings;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:
Wingdings'>J</span></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l1 level1 lfo10;tab-stops:list .5in'>E-Mail
     : ( <a href="mailto:marius_hudea@personal.ro">marius_hudea@personal.ro</a>
     )</li>
</ul>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l6 level1 lfo9;tab-stops:list .5in'>Snail-Mail:</li>
</ul>

<p class=MsoNormal><span style="mso-spacerun: yes">      </span>Marius Hudea</p>

<p class=MsoNormal><span style="mso-spacerun: yes">      </span>C.I.Bratianu 5
Nr.5 Ap.27 Et.4 Sc.B</p>

<p class=MsoNormal><span style="mso-spacerun: yes">      </span>Medias, Cod
3125, Sibiu</p>

<p class=MsoNormal><span style="mso-spacerun: yes">      </span>ROMANIA</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span></p>

</div>

</body>

</html>
